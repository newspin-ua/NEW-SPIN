<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<title>üéÅ PROCASE</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover">
<script src="https://telegram.org/js/telegram-web-app.js"></script>
<style>
body {
  margin:0;
  background:radial-gradient(circle at top,#0b1d2a,#050505);
  color:#fff;
  font-family:Arial,sans-serif;
  text-align:center;
}
h1 {
  color:#00c3ff;
  text-shadow:0 0 15px #00c3ff;
}
canvas {
  width:85vw;
  max-width:340px;
  border-radius:50%;
  background:#000;
  box-shadow:0 0 35px #00c3ff;
}
#pointer {
  margin:8px auto;
  width:0;
  height:0;
  border-left:18px solid transparent;
  border-right:18px solid transparent;
  border-bottom:36px solid #00eaff;
}
button {
  background:linear-gradient(90deg,#0077ff,#00c3ff);
  border:none;
  border-radius:16px;
  color:white;
  padding:14px 38px;
  font-size:18px;
  box-shadow:0 0 25px #00c3ff;
}
.result {
  font-size:26px;
  margin-top:14px;
}
.chanceBox {
  margin-top:12px;
  background:rgba(0,0,0,.5);
  display:inline-block;
  padding:10px 18px;
  border-radius:14px;
}
.chance.green{color:#3cff00}
.chance.red{color:#ff2a2a}
.chance.gray{color:#bfbfbf}
.star {
  position:fixed;
  font-size:28px;
  pointer-events:none;
  animation:fly 1.6s ease-out forwards;
}
@keyframes fly {
  from {opacity:1;transform:scale(.4)}
  to {opacity:0;transform:scale(1.4) translate(var(--x),var(--y)) rotate(360deg);}
}
</style>
</head>
<body>
<h1>üéÅ PROCASE</h1>
<canvas id="wheel" width="340" height="340"></canvas>
<div id="pointer"></div>
<button id="spin">–ö—Ä—É—Ç–∏—Ç–∏</button>
<div class="result" id="result"></div>
<div class="chanceBox">
  <div class="chance green">‚≠êÔ∏è 1 ‚Äî 24%</div>
  <div class="chance red"> 0 ‚Äî 75.99%</div>
  <div class="chance gray">‚≠êÔ∏è‚≠êÔ∏è‚≠êÔ∏è 3 ‚Äî 0.01%</div>
</div>

<script>
Telegram.WebApp.ready();
Telegram.WebApp.expand();

const canvas = document.getElementById("wheel");
const ctx = canvas.getContext("2d");
const result = document.getElementById("result");

const segments = [
  {color:"#3cff00", text:"‚≠êÔ∏è", type:"one", size:1},
  {color:"#ff2a2a", text:"", type:"zero", size:1},
  {color:"#3cff00", text:"‚≠êÔ∏è", type:"one", size:1},
  {color:"#ff2a2a", text:"", type:"zero", size:1},
  {color:"#3cff00", text:"‚≠êÔ∏è", type:"one", size:1},
  {color:"#ff2a2a", text:"", type:"zero", size:1},
  {color:"#3cff00", text:"‚≠êÔ∏è", type:"one", size:1},
  {color:"#ff2a2a", text:"", type:"zero", size:1},
  {color:"#3cff00", text:"‚≠êÔ∏è", type:"one", size:1},
  {color:"#ff2a2a", text:"", type:"zero", size:1},
  {color:"#dfdfdf", text:"‚≠êÔ∏è‚≠êÔ∏è‚≠êÔ∏è", type:"three", size:0.5},
];

let angle = 0;

function drawWheel() {
  const cx = 170, cy = 170, r = 155;
  const total = segments.reduce((s,a)=>s+a.size,0);
  let a = angle;

  ctx.clearRect(0,0,340,340);

  // –ú–∞–ª—é—î–º–æ —Å–µ–≥–º–µ–Ω—Ç–∏
  segments.forEach(s=>{
    const slice = (s.size/total)*Math.PI*2;
    ctx.beginPath();
    ctx.moveTo(cx,cy);
    ctx.arc(cx,cy,r,a,a+slice);
    ctx.fillStyle=s.color;
    ctx.fill();

    // –¢–µ–∫—Å—Ç –Ω–∞ —Å–µ–≥–º–µ–Ω—Ç—ñ
    const mid = a+slice/2;
    ctx.save();
    ctx.translate(cx+Math.cos(mid)*r*0.6, cy+Math.sin(mid)*r*0.6);
    ctx.rotate(mid);
    ctx.fillStyle="#fff";
    ctx.font="bold 20px Arial";
    ctx.fillText(s.text,-12,6);
    ctx.restore();

    a+=slice;
  });

  // –ú–∞–ª—é—î–º–æ –∂–æ–≤—Ç—ñ –∫—Ä—É–∂–µ—á–∫–∏ –ø–æ –∫–æ–ª—É
  const bulbs = 20; // –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ª–∞–º–ø–æ—á–æ–∫
  for(let i=0;i<bulbs;i++){
    const theta = (i/bulbs)*2*Math.PI + angle; // —â–æ–± –∫—Ä—É–∂–µ—á–∫–∏ –æ–±–µ—Ä—Ç–∞–ª–∏—Å—å —Ä–∞–∑–æ–º
    const bx = cx + Math.cos(theta)*(r+15);
    const by = cy + Math.sin(theta)*(r+15);
    ctx.beginPath();
    ctx.arc(bx,by,6,0,2*Math.PI);
    ctx.fillStyle = "#ffea00";
    ctx.shadowColor = "#ffd700";
    ctx.shadowBlur = 8;
    ctx.fill();
    ctx.shadowBlur = 0;
  }
}

function explode(n){
  for(let i=0;i<n;i++){
    const s=document.createElement("div");
    s.className="star";
    s.textContent="‚≠êÔ∏è";
    s.style.left="50%";
    s.style.top="50%";
    s.style.setProperty("--x",(Math.random()-.5)*300+"px");
    s.style.setProperty("--y",(Math.random()-.5)*300+"px");
    document.body.appendChild(s);
    setTimeout(()=>s.remove(),1600);
  }
}

drawWheel();

document.getElementById("spin").onclick=()=>{
  let r=Math.random(), type="zero";
  if(r<0.0001) type="three";
  else if(r<0.24) type="one";

  const opts=segments.map((s,i)=>({...s,i})).filter(s=>s.type===type);
  const pick=opts[Math.floor(Math.random()*opts.length)];

  const total=segments.reduce((s,a)=>s+a.size,0);
  let offset=0;
  for(let i=0;i<pick.i;i++) offset+=segments[i].size;
  const target=(offset/total)*Math.PI*2;

  const spin=6*Math.PI+(Math.PI*2-target);
  const start=angle;
  const t0=performance.now();

  function anim(t){
    const p=Math.min((t-t0)/3500,1);
    angle=start+spin*(1-Math.pow(1-p,3));
    drawWheel();
    if(p<1) requestAnimationFrame(anim);
    else{
      if(type==="three"){
        result.textContent="üíé ‚≠êÔ∏è‚≠êÔ∏è‚≠êÔ∏è 3 –ó–Ü–†–ö–ò!";
        explode(30);
      } else if(type==="one"){
        result.textContent="üéâ ‚≠êÔ∏è 1 –ó–Ü–†–ö–ê";
        explode(14);
      } else {
        result.textContent="üò¢  0 –ó–Ü–†–û–ö";
      }
    }
  }
  requestAnimationFrame(anim);
};
</script>
</body>
</html>
